describe("ConsoleReporter",function(){function e(e){return"[32m"+e+"[0m"}function t(e){return"[31m"+e+"[0m"}function n(e){return"[33m"+e+"[0m"}function r(e){return"[32m"+e}function i(e){return"[31m"+e}function s(e,t){for(var n=0;n<t;n++)e(t+1)}function o(e,t){var n=[];for(var r=0;r<t;r++)n.push(e);return n}function u(e,t,n,r,i,s){e.reportRunnerStarting();for(var o=0;o<t.length;o++)e.reportSpecResults(t[o]);for(o=0;o<n.length;o++)e.reportSuiteResults(n[o]);e.runnerStartTime=i,e.now=function(){return s},e.reportRunnerResults(r)}var a="\n",f={results:function(){return{passed:function(){return!0}}}},l={results:function(){return{passed:function(){return!1}}}},c={results:function(){return{skipped:!0}}},h={specs:function(){return[null,null,null]},results:function(){return{failedCount:0,items_:[null,null,null]}}},p={specs:function(){return[null,null,null]},results:function(){return{failedCount:7,items_:[null,null,null]}}},d,v,m;beforeEach(function(){v=function(){var e="";return{print:function(t){e+=t},getOutput:function(){return e},clear:function(){e=""}}}(),m=!1,d=new jasmine.ConsoleReporter(v.print,function(e){m=!0})}),describe("Integration",function(){it("prints the proper output under a pass scenario - small numbers.",function(){u(d,o(f,3),[],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}},1e3,1777);var e=v.getOutput();expect(e).toMatch(/^Started/),expect(e).toMatch(/\.\.\./),expect(e).toMatch(/3 specs, 0 failures/)}),it("prints the proper output under a pass scenario.  large numbers.",function(){u(d,o(f,57),[],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}},1e3,1777);var e=v.getOutput();expect(e).toMatch(/^Started/),expect(e).toMatch(/\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\.\./),expect(e).toMatch(/3 specs, 0 failures/)}),it("prints the proper output under a failure scenario.",function(){u(d,[l,f,l],[{description:"The oven",results:function(){return{items_:[{failedCount:2,description:"heats up",items_:[{trace:{stack:"stack trace one\n  second line"}},{trace:{stack:"stack trace two"}}]}]}}},{description:"The washing machine",results:function(){return{items_:[{failedCount:2,description:"washes clothes",items_:[{trace:{stack:"stack trace one"}}]}]}}}],{specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:2}}},1e3,1777);var e=v.getOutput();expect(e).toMatch(/^Started/),expect(e).toMatch(/F\.F/),expect(e).toMatch(/The oven heats up\n  stack trace one\n    second line\n  stack trace two/),expect(e).toMatch(/The washing machine washes clothes\n  stack trace one/),expect(e).toMatch(/3 specs, 2 failures/)})}),describe("When a Jasmine environment executes",function(){beforeEach(function(){d.reportRunnerStarting()}),it("should print 'Started' to the console",function(){expect(v.getOutput()).toEqual("Started"+a)}),describe("when a spec reports",function(){beforeEach(function(){v.clear()}),it("prints a green dot if the spec passes",function(){d.reportSpecResults(f),expect(v.getOutput()).toMatch(/\./)}),it("prints a red dot if the spec fails",function(){d.reportSpecResults(l),expect(v.getOutput()).toMatch(/F/)}),it("prints a yellow star if the spec was skipped",function(){d.reportSpecResults(c),expect(v.getOutput()).toMatch(/\*/)})}),describe("when a suite reports",function(){var e;beforeEach(function(){e=function(){return{items_:[]}}}),it("remembers suite results",function(){d.reportSuiteResults({description:"Oven",results:e}),d.reportSuiteResults({description:"Mixer",results:e}),expect(d.suiteResults[0].description).toEqual("Oven"),expect(d.suiteResults[1].description).toEqual("Mixer")}),it("creates a description out of the current suite and any parent suites",function(){var t={description:"My house",results:e},n={description:"kitchen",parentSuite:t,results:e};d.reportSuiteResults({description:"oven",parentSuite:n,results:e}),expect(d.suiteResults[0].description).toEqual("My house kitchen oven")}),it("gathers failing spec results from the suite - the spec must have a description.",function(){d.reportSuiteResults({description:"Oven",results:function(){return{items_:[{failedCount:0,description:"specOne"},{failedCount:99,description:"specTwo"},{failedCount:0,description:"specThree"},{failedCount:88,description:"specFour"},{failedCount:3}]}}}),expect(d.suiteResults[0].failedSpecResults).toEqual([{failedCount:99,description:"specTwo"},{failedCount:88,description:"specFour"}])})}),describe("and finishes",function(){describe("when reporting spec failure information",function(){it("prints suite and spec descriptions together as a sentence",function(){d.suiteResults=[{description:"The oven",failedSpecResults:[{description:"heats up",items_:[]},{description:"cleans itself",items_:[]}]},{description:"The mixer",failedSpecResults:[{description:"blends things together",items_:[]}]}],d.reportRunnerResults(p),expect(v.getOutput()).toContain("The oven heats up"),expect(v.getOutput()).toContain("The oven cleans itself"),expect(v.getOutput()).toContain("The mixer blends things together")}),it("prints stack trace of spec failure",function(){d.suiteResults=[{description:"The oven",failedSpecResults:[{description:"heats up",items_:[{trace:{stack:"stack trace one"}},{trace:{stack:"stack trace two"}}]}]}],d.reportRunnerResults(p),expect(v.getOutput()).toContain("The oven heats up"),expect(v.getOutput()).toContain("stack trace one"),expect(v.getOutput()).toContain("stack trace two")})}),describe("when reporting the execution time",function(){it("prints the full finished message",function(){d.now=function(){return 1e3},d.reportRunnerStarting(),d.now=function(){return 1777},d.reportRunnerResults(p),expect(v.getOutput()).toContain("Finished in 0.777 seconds")}),it("prints round time numbers correctly",function(){function e(e,t){v.clear(),d.runnerStartTime=e,d.now=function(){return t},d.reportRunnerResults(h)}e(1e3,11e3),expect(v.getOutput()).toContain("10 seconds"),e(1e3,2e3),expect(v.getOutput()).toContain("1 seconds"),e(1e3,1100),expect(v.getOutput()).toContain("0.1 seconds"),e(1e3,1010),expect(v.getOutput()).toContain("0.01 seconds"),e(1e3,1001),expect(v.getOutput()).toContain("0.001 seconds")})}),describe("when reporting the results summary",function(){it("prints statistics in green if there were no failures",function(){d.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}}),expect(v.getOutput()).toContain("3 specs, 0 failures")}),it("prints statistics in red if there was a failure",function(){d.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:3}}}),expect(v.getOutput()).toContain("3 specs, 3 failures")}),it("handles pluralization with 1's ones appropriately",function(){d.reportRunnerResults({specs:function(){return[null]},results:function(){return{items_:[null],totalCount:1,failedCount:1}}}),expect(v.getOutput()).toContain("1 spec, 1 failure")})}),describe("done callback",function(){it("calls back when done",function(){expect(m).toBeFalsy(),d.reportRunnerResults({specs:function(){return[null,null,null]},results:function(){return{items_:[null,null,null],totalCount:7,failedCount:0}}}),expect(m).toBeTruthy()})})})})});